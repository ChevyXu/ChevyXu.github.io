---
layout:	post
title:	å¦‚ä½•0åŸºç¡€éƒ¨ç½²Rçš„shiny app
subtitle:	è¿‡è€…ä¹‹æ‚£ï¼Œä¸çŸ¥è€Œè‡ªä»¥ä¸ºçŸ¥ã€‚
date:	2019-12-10
author:	Chevy
header-img:	img/15.jpg
catalog:	true
tags:
    - æŠ€æœ¯å­¦ä¹ ç¬”è®°


---

### Why we need visualization by web

> ç›®å‰çš„å•ç»†èƒå®éªŒæ–‡ç« ï¼Œå¤§å®¶éƒ½ä¼šä¹ æƒ¯æŠŠè‡ªå·±çš„æ•°æ®åšæˆä¸€ä¸ªæ•°æ®åº“çš„å½¢å¼ï¼Œæ–¹ä¾¿è¯»è€…è¿›è¡Œæ£€ç´¢ï¼Œé‚£ä¹ˆï¼ˆé›¶åŸºç¡€çš„ï¼‰æˆ‘ä»¬è¯¥å¦‚ä½•åšä¸€ä¸ªç½‘ç«™æ¥å±•ç¤ºæˆ‘ä»¬çš„æ•°æ®ç»“æœå‘¢ï¼Ÿ

ä¾‹å¦‚æˆ‘çŸ¥é“èº«è¾¹çš„[æ´²æ›´åŒå­¦](xuzhougeng.top)å°±åšäº†ä¸¤ä¸ªå·¥å…·ç½‘ç«™ï¼Œç¾è§‚ä¸”å®ç”¨ï¼Œæœ‰å…´è¶£çš„å¤§å®¶å¯ä»¥ç‚¹è¿›å»ä¸€è§ˆç©¶ç«Ÿï¼š

1. [BSA](http://xuzhougeng.top/BSA)

2. [RNA-seq](http://xuzhougeng.top/RNA-seq-downstream-analysis/)

### Which tools to use

> ä½œä¸ºä¸€ä¸ªRè¯­è¨€çš„ä½¿ç”¨è€…ï¼Œæˆ‘å¾ˆåº†å¹¸å‰äººåœ¨æ­¤é¢†åŸŸå·²ç»è¿›è¡Œäº†æå¤§çš„å¼€æ‹“ï¼ŒRstudioçš„å·¥ä½œäººå‘˜å¼€å‘äº†shinyè¿™ä¸ªåŒ…æ¥è¿›è¡Œæ•°æ®çš„äº¤äº’å¯è§†åŒ–ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å°†å…¶éƒ¨ç½²åˆ°serverä¸Šä¸è¯»è€…è¿›è¡Œåˆ†äº«

å½“ç„¶ï¼Œæœ¬æ¬¡è¯¾ç¨‹çš„ç›®çš„ä¸æ˜¯æ•™ä½ æ€ä¹ˆç”¨shinyå†™appï¼Œæ¯•ç«ŸRstudioä¸Šçš„æ•™ç¨‹å·²ç»å†™çš„å¾ˆæ¸…æ¥šäº†ï¼Œå¹¶ä¸”[Rstudio](https://shiny.rstudio.com/gallery/)å®˜æ–¹å°±ç»™å‡ºäº†å¾ˆå¤šçš„ç¤ºä¾‹ä»¥åŠåœ¨[showmeshiny](https://www.showmeshiny.com/)é‡Œä¹Ÿæœ‰å¾ˆå¤šåŒ…å«äº†codeçš„ç¤ºä¾‹app

**æ‰€ä»¥æœ¬æ¬¡ä»‹ç»çš„æ˜¯ï¼ˆé›¶åŸºç¡€çš„ï¼‰æˆ‘ä»¬ä½¿ç”¨shinyå¼€å‘ä¸€ä¸ªå·¥å…·ç½‘é¡µ**

### What do you need to build a shiny web

> a server or some money

äº‹å®ä¸Šï¼Œç”¨æˆ·å¯ä»¥åœ¨è‡ªå·±çš„PCä¸Šå°±å¯ä»¥å®Œæˆä¸€ä¸ªshiny appçš„ç¼–å†™ï¼Œä½†æ˜¯é—®é¢˜å°±åœ¨äºå½“ä½ è¿è¡Œshinyä»¥åï¼Œä½ æ‰“å¼€æµè§ˆå™¨æ˜¯ç›‘å¬æœ¬åœ°ç«¯å£çš„ï¼Œåˆ«äººæ²¡æœ‰è®¿é—®ä½ ç”µè„‘çš„æƒé™ï¼Œæ‰€ä»¥ä½ æ˜¯æ²¡æœ‰åŠæ³•è®©åˆ«äººçœ‹åˆ°ä½ çš„æ•°æ®æˆ–è€…ä½¿ç”¨ä½ ç¼–å†™çš„å·¥å…·çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥æ‹¥æœ‰ä¸¤ä¸ªåŸºæœ¬é€‰é¡¹ï¼š

1. å°†ä½ çš„shiny appä»¥ä»£ç çš„å½¢å¼åˆ†äº«ç»™åˆ«äºº
   - ä¼˜ç‚¹ï¼šç®€å•ï¼Œåªéœ€è¦ä»£ç ä¼ è¾“å°±å¯ä»¥äº†ï¼Œä¾‹å¦‚GitHub
     - å¯ä»¥ä½¿ç”¨`runUrl`, `runGithub`, `runGist`ç­‰å‡½æ•°è·å–åœ¨çº¿app
   - ç¼ºç‚¹ï¼šéœ€è¦åˆ«äººä¼šç”¨Rï¼ˆå¦‚æœæœ‰å¤§çš„æ•°æ®é‡çš„è¯ï¼Œå°±ä¼šæ¯”è¾ƒéº»çƒ¦ï¼‰
2. å°†ä½ çš„shiny appä»¥ç½‘é¡µçš„å½¢å¼åˆ†äº«ç»™åˆ«äºº
   - æœ‰ç‚¹ï¼šå‹å¥½çš„äº¤äº’å½¢å¼ï¼Œåªè¦æœ‰ç½‘å°±å¯ä»¥æŸ¥çœ‹æ•°æ®æˆ–è€…ä½¿ç”¨å·¥å…·
   - ç¼ºç‚¹ï¼šä½ éœ€è¦æœ‰ä¸€ç‚¹åŸºæœ¬çš„ç½‘é¡µé…ç½®çŸ¥è¯†å’Œä¸€äº›ç¡¬ä»¶

**æˆ‘ä»¬çš„é€‰æ‹©æ˜¯2ï¼Œè®©åˆ«äººæ— é—¨æ§›çš„è®¿é—®æˆ‘ä»¬çš„shiny app**

é‚£ä¹ˆï¼Œå°†ä½ çš„shiny appä»¥ç½‘é¡µçš„å½¢å¼åˆ†äº«ç»™åˆ«äººéœ€è¦å“ªäº›ç¡¬ä»¶å‘¢ï¼Ÿ

- ä¸€å°è”ç½‘çš„æœåŠ¡å™¨
- shiny appä»£ç ç¼–å†™åŠæµ‹è¯•çš„èƒ½åŠ›
- ä¸€ä¸ªå–„äºå°è¯•åŠæ‘¸ç´¢çš„å¤§è„‘

**ä»¥ä¸Šä¸‰ä¸ªæ¡ä»¶çš„é‡è¦æ€§ä¾æ¬¡é€’å¢**

### By which way could we build a shiny web

ç›®å‰æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥åˆ°è¾¾æˆ‘ä»¬çš„ç›®çš„ï¼Œä¾æ¬¡ä¸ºï¼š

1. ã€å¯èƒ½æ˜¯æœ€ç®€å•çš„ç™½å«–æ–¹æ³•ã€‘ä½¿ç”¨shinyå®˜æ–¹å‡ºç‰ˆçš„shiny appæ‰˜ç®¡æœåŠ¡å³[shinyapps.io](http://www.shinyapps.io/)ï¼Œæ— éœ€ä½ é…ç½®æœåŠ¡å™¨ä»¥åŠè®¾ç½®å‚æ•°ï¼Œåªéœ€è¦ç‚¹ç‚¹é¼ æ ‡ï¼Œä¸Šä¼ ä½ çš„shiny appå°±å¯ä»¥å•¦ï¼Œè€Œä¸”å…è´¹è´¦æˆ·å°±æœ‰å¯èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚äº†ï¼ˆå…è´¹æ‰˜ç®¡äº”ä¸ªapp aplicationsï¼‰ï¼Œç™½å«–ä¸‡å²ï¼ˆå†ä¸è¡Œå°±èŠ±ç‚¹é’±ï¼Œå“ªæ€•*å‘¢ï¼‰
2. ã€é«˜é˜¶ç”¨æˆ·çš„é¦–é€‰ã€‘ä½¿ç”¨[RStudio Connect](https://www.rstudio.com/products/connect/)ï¼Œå¦‚æœä½ æ˜¯è¥åˆ©æ€§çš„ç›®çš„ï¼Œå¹¶ä¸”æ•°æ®ä¸å‡†å¤‡å…¬å¼€ï¼ˆå¯†ç ç™»å½•æˆæƒç­‰ï¼‰ï¼Œé‚£ä¹ˆRStudio Connectå¯èƒ½æ˜¯ä½ éœ€è¦è€ƒè™‘ä½¿ç”¨çš„
3. ã€ç»ä¸è®¤è¾“çš„æ•‘èµä¹‹è·¯ã€‘å¦‚æœä½ æƒ³æŠ˜è…¾ï¼Œåˆæœ‰è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆä½¿ç”¨shiny serverå»å‘å¸ƒä½ çš„shiny appä¸€å®šæ˜¯ä¸äºŒä¹‹é€‰

### Pipeline for publish a web on server

> æˆ‘ä½¿ç”¨çš„ä¸ºå°å‹VPSï¼Œé…ç½®ä¸é«˜ä½†æ˜¯å¤Ÿç”¨ï¼ŒåŒæ—¶æ‹¥æœ‰rootæƒé™

é¦–å…ˆæ˜¯[Download Shiny Server](https://rstudio.com/products/shiny/download-server/)ï¼Œä¸åŒçš„ç³»ç»Ÿæœ‰ä¸åŒçš„ä¸‹è½½æ–¹å¼ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯CentOS 7ï¼Œå¤§å®¶æ ¹æ®å®˜ç½‘æ•™ç¨‹æ“ä½œå°±å¯ä»¥äº†ï¼š

```shell
# å®‰è£…EPEL
yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
# å®‰è£…R
sudo yum install R
# å®‰è£…shiny
sudo su - -c "R -e \"install.packages('shiny', repos='https://cran.rstudio.com/')\""
# æˆ–è€…åœ¨Linuxå†…è¿›å…¥Rï¼Œæ‰‹åŠ¨å®‰è£…shinyåŠå…¶ä¾èµ–åŒ…

# éšåä¸‹è½½shiny serverå¹¶å®‰è£…
wget https://download3.rstudio.org/centos6.3/x86_64/shiny-server-1.5.12.933-x86_64.rpm
sudo yum install --nogpgcheck shiny-server-1.5.12.933-x86_64.rpm
```

åˆ°è¿™ä¸€æ­¥ä½ å°±å·²ç»å®Œæˆäº†shiny serverçš„é…ç½®ï¼ˆå¯èƒ½ä¼šå‡ºä¸€äº›å®‰è£…ä¸Šçš„å°éº»çƒ¦ï¼Œä½†æ˜¯è§å±±å¼€è·¯ï¼Œé‡æ°´æ­æ¡¥ï¼Œè§£å†³é—®é¢˜æ˜¯æå‡è‡ªå·±çš„å¿…ç”±ä¹‹è·¯ï¼‰

éšåä½ å¯ä»¥å°†ä½ çš„shiny appä¸Šä¼ åˆ°æœåŠ¡å™¨çš„` /srv/shiny-server/`ä½ç½®ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥æœåŠ¡å™¨çš„IPç›‘å¬ç«¯å£åŠåŒ…åå°±ğŸ†—äº†ï¼Œæ ¼å¼ä¸º`http://<hostname>:3838/APP_NAME/`ï¼Œä»£ç æ¼”ç¤ºï¼š

```shell
# è‡ªå¸¦ç¤ºä¾‹æ–‡ä»¶æ¼”ç¤º
cp -R /your-path-wo-shiny/shiny/examples/* /srv/shiny-server/

# æˆ‘çš„æ•°æ®
(base)  âš¡ root@Chevy î‚° ~ î‚° cd /srv/shiny-server 
(base)  âš¡ root@Chevy î‚° /srv/shiny-server î‚° ll
total 44K
drwxr-xr-x 2 root root 4.0K Dec  4 04:21 01_hello
drwxr-xr-x 2 root root 4.0K Dec  4 04:21 02_text
drwxr-xr-x 2 root root 4.0K Dec  4 04:21 03_reactivity
drwxr-xr-x 2 root root 4.0K Dec  4 04:21 04_mpg
drwxr-xr-x 2 root root 4.0K Dec  4 04:21 05_sliders
drwxr-xr-x 2 root root 4.0K Dec  4 04:21 06_tabsets
drwxr-xr-x 2 root root 4.0K Dec  4 04:21 07_widgets
drwxr-xr-x 3 root root 4.0K Dec  4 04:21 08_html
drwxr-xr-x 2 root root 4.0K Dec  4 04:21 09_upload
drwxr-xr-x 2 root root 4.0K Dec  4 04:21 10_download
drwxr-xr-x 2 root root 4.0K Dec  4 04:21 11_timer
lrwxrwxrwx 1 root root   38 Dec  4 04:20 index.html -> /opt/shiny-server/samples/welcome.html
lrwxrwxrwx 1 root root   37 Dec  4 04:20 sample-apps -> /opt/shiny-server/samples/sample-apps
```

### Example

æˆ‘çš„æµ‹è¯•ç»“æœï¼Œå¯ç‚¹å‡»ï¼ˆæ¯”è¾ƒæ…¢ï¼Œå°æ°´ç®¡VPSï¼‰

[Chevy's shiny example](http://104.224.178.164:3838/sample-apps/hello/)